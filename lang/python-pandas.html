<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Expressiveness Benchmark</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-16662292-3"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag(&#x27;js&#x27;, new Date());

        gtag(&#x27;config&#x27;, &#x27;UA-16662292-3&#x27;);
        </script><meta name="next-head-count" content="5"/><link rel="preload" href="/expressiveness-benchmark/_next/static/css/bb7eb15fa0f289a0fe43.css" as="style"/><link rel="stylesheet" href="/expressiveness-benchmark/_next/static/css/bb7eb15fa0f289a0fe43.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/_app-73083bb29ec45f84b02a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.9662a54cf737546376a6.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/lang/%5Bid%5D-e6258ee591b96865bd9a.js" as="script"/></head><body><div id="__next"><div id="container"><div class="title"><h1><a href="/expressiveness-benchmark">Expressiveness Benchmark</a></h1><nav><span class="desktop-inline"><a href="/expressiveness-benchmark">Task matrix</a></span><span class="mobile-inline"><a href="/expressiveness-benchmark">Benchmark</a></span><a href="/expressiveness-benchmark/analysis">Dataset analysis</a></nav></div><div class="pivot-view"><h2>Language<!-- -->: <!-- -->Python - Pandas</h2><div class="column-container"><div class="main-content"><div class="main-scroll"><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/continent_by_population">Continent with the highest average population</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:69px"></div></div><pre style="width:100%;height:69px;line-height:1.3em">def continent_by_population(countries):
  mean_pop = countries.groupby(&#x27;continent&#x27;).population.mean()
  return mean_pop.index[mean_pop.argmax()]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/changing_mean">First element that doesn&#x27;t change mean</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:138px"></div></div><pre style="width:100%;height:138px;line-height:1.3em">

def changing_mean(vals):
  mean = vals.value.mean()
  mean_without = vals.apply(lambda row: vals[vals.id != row.id].value.mean(), axis=1)
  return vals[(mean_without - mean).abs() &lt; 0.1].id.tolist()
</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/continent_median_population">Median population for each continent</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:115px"></div></div><pre style="width:100%;height:115px;line-height:1.3em">def continent_median_population(countries):
  return (countries
      .groupby(&#x27;continent&#x27;)
      .population.median()
      .reset_index())</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/youngest_over_35">Youngest person over 35</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">def youngest_over_35(people):
  over_35 = people[people.age &gt; 35]
  if len(over_35) == 0: 
    return None
  else:
    youngest = over_35.loc[over_35.age.idxmin()]
    return youngest[&#x27;name&#x27;]</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/tom_hanks">Directors of movies Tom Hanks starred in</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">

def tom_hanks(actors,directors):
  movies = list(actors.loc[
    actors[&#x27;actor&#x27;] == &#x27;Tom Hanks&#x27;, &#x27;movie&#x27;])
  return directors[directors[&#x27;movie&#x27;].
    isin(movies)][&#x27;director&#x27;]
</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/row_per_child">Row per family to row per child</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:207px"></div></div><pre style="width:100%;height:207px;line-height:1.3em">def row_per_child(families):
  df = pd.wide_to_long(
    families, 
    stubnames=[&#x27;dob&#x27;, &#x27;height&#x27;], 
    sep=&quot;_child&quot;, 
    i=&#x27;family&#x27;, 
    j=&#x27;child&#x27;).reset_index()
  df.child = df.child.map(lambda c: f&#x27;child{c}&#x27;)
  return df</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/strings_to_numbers">Convert strings with different formats to numbers</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:115px"></div></div><pre style="width:100%;height:115px;line-height:1.3em">def strings_to_numbers(numbers):
  def convert(row):
    sep = &quot;,&quot; if row.format == &#x27;comma_sep&#x27; else &quot;_&quot;
    return int(row.value.replace(sep, &quot;&quot;))
  return numbers.apply(convert, axis=1).tolist()</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/documents_with_infrequent_words">Documents with infrequent words</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">def documents_with_infrequent_words(documents):
  words = documents.text.str.split(&quot; &quot;, expand=True)
  freq = words.stack().value_counts()
  infrequent_words = freq[freq == 1].index.values
  infrequent_docs = documents[
    np.isin(words.values, infrequent_words)]
  return infrequent_docs.id.unique().tolist()</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/process_tweets">Filter and clean tweets</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:138px"></div></div><pre style="width:100%;height:138px;line-height:1.3em">def process_tweets(data):
  result = data[
    (data.language == &#x27;en&#x27;) &amp;
    (data.is_retweet == &#x27;false&#x27;)]
  result.body = result.body.apply(lambda s: s.lower())
  return result[[&quot;body&quot;, &quot;ts&quot;]]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/purchased_all_food">People that purchased all possible items</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">def purchased_all_food(food, orders):
  n_food = len(food)
  n_unique_orders = (orders
    .groupby(&#x27;buyer&#x27;)
    .food.unique() 
    .map(len))
  return n_unique_orders[n_unique_orders == n_food].index.values</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/unique_beer_drinkers">People who like a unique set of beer</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:322px"></div></div><pre style="width:100%;height:322px;line-height:1.3em">def unique_beer_drinkers(likes):
  likes_per_person = (likes
    .groupby(&#x27;name&#x27;)
    .beer.unique().map(set)
    .reset_index())

  def check_not_exists(row):
    other_people = likes_per_person[
      likes_per_person.name != row[&#x27;name&#x27;]]
    return not (other_people.beer == row[&#x27;beer&#x27;]).any()
  
  unique_drinkers = likes_per_person[
    likes_per_person.apply(check_not_exists, axis=1)]
  return unique_drinkers.name.tolist()</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/rolling_average">Rolling average</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:253px"></div></div><pre style="width:100%;height:253px;line-height:1.3em">def rolling_average(data):
  d = data.copy()

  data.time = pd.to_datetime(data.time * 10**9)
  data = (data.sort_values(&#x27;time&#x27;).set_index(&#x27;time&#x27;)
              .rolling(window=&#x27;7s&#x27;).mean())

  return pd.DataFrame.from_dict(
    {&#x27;end_time&#x27;: d.sort_values(&#x27;time&#x27;).reset_index().time,
     &#x27;average&#x27;: data.reset_index().x}
  )</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/average_window">Windowed average</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:138px"></div></div><pre style="width:100%;height:138px;line-height:1.3em">def average_window(data):
  def window(t):
    return math.floor(t / 7)
  result = (data.sort_values(&quot;time&quot;)
                .set_index(&quot;time&quot;).groupby(window).mean())
  return result[&#x27;x&#x27;].tolist()</pre></div></div></div></div></div><div class="sidebar"><div class="sidebar-sticky"><div class="minimap"><button class="toggle">Toggle All</button><div><input type="checkbox" checked=""/>Continent with the highest average population</div><div><input type="checkbox" checked=""/>First element that doesn&#x27;t change mean</div><div><input type="checkbox" checked=""/>Median population for each continent</div><div><input type="checkbox" checked=""/>Youngest person over 35</div><div><input type="checkbox" checked=""/>Directors of movies Tom Hanks starred in</div><div><input type="checkbox" checked=""/>Row per family to row per child</div><div><input type="checkbox" checked=""/>Convert strings with different formats to numbers</div><div><input type="checkbox" checked=""/>Documents with infrequent words</div><div><input type="checkbox" checked=""/>Filter and clean tweets</div><div><input type="checkbox" checked=""/>People that purchased all possible items</div><div><input type="checkbox" checked=""/>People who like a unique set of beer</div><div><input type="checkbox" checked=""/>Rolling average</div><div><input type="checkbox" checked=""/>Windowed average</div></div></div></div></div></div><footer>Project by <a href="https://twitter.com/wcrichton">Will Crichton</a>, <a href="https://github.com/kovach">Scott Kovach</a>, and <a href="http://gleb.fyi/">Gleb Shevchuk</a>.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"lang":{"id":"python-pandas","name":"Python - Pandas"}},"__N_SSG":true},"page":"/lang/[id]","query":{"id":"python-pandas"},"buildId":"UAi9pXhyWdjqPaekVeAOd","assetPrefix":"/expressiveness-benchmark","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/expressiveness-benchmark/_next/static/chunks/polyfills-d2769c16f665abc9d1ae.js"></script><script src="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/_app-73083bb29ec45f84b02a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.9662a54cf737546376a6.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/lang/%5Bid%5D-e6258ee591b96865bd9a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/UAi9pXhyWdjqPaekVeAOd/_buildManifest.js" async=""></script><script src="/expressiveness-benchmark/_next/static/UAi9pXhyWdjqPaekVeAOd/_ssgManifest.js" async=""></script></body></html>