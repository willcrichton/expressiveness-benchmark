<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Expressiveness Benchmark</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-16662292-3"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag(&#x27;js&#x27;, new Date());

        gtag(&#x27;config&#x27;, &#x27;UA-16662292-3&#x27;);
        </script><meta name="next-head-count" content="5"/><link rel="preload" href="/expressiveness-benchmark/_next/static/css/1155596c144f6189cf34.css" as="style"/><link rel="stylesheet" href="/expressiveness-benchmark/_next/static/css/1155596c144f6189cf34.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/_app-45b4e7d3d7685d44ce45.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.456f604e8bed4feda205.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/lang/%5Bid%5D-69454a6dd0b4a4f0e0f7.js" as="script"/></head><body><div id="__next"><div id="container"><div class="title"><h1><a href="/expressiveness-benchmark">Expressiveness Benchmark</a></h1><nav><span class="desktop-inline"><a href="/expressiveness-benchmark">Task matrix</a></span><span class="mobile-inline"><a href="/expressiveness-benchmark">Benchmark</a></span><a href="/expressiveness-benchmark/analysis">Dataset analysis</a></nav></div><div class="pivot-view"><h2>Language<!-- -->: <!-- -->SQL - SQLite</h2><div class="column-container"><div class="main-content"><div class="main-scroll"><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/continent_by_population">Continent with the highest average population</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:115px"></div></div><pre style="width:100%;height:115px;line-height:1.3em">SELECT continent 
FROM countries
GROUP BY continent
ORDER BY AVG(population) DESC
LIMIT 1</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/changing_mean">First element that doesn&#x27;t change mean</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">SELECT id
FROM vals v1
WHERE ABS((
  SELECT AVG(value)
  FROM vals v2
  WHERE v1.id != v2.id
) - (SELECT AVG(value) FROM vals)) &lt; 0.1</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/continent_median_population">Median population for each continent</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:276px"></div></div><pre style="width:100%;height:276px;line-height:1.3em">SELECT continent, AVG(population) as population
FROM
  (SELECT *, 
    row_number() OVER 
      (PARTITION BY continent ORDER BY population) AS rank, 
    count() OVER 
      (PARTITION BY continent) as count
  FROM countries)
WHERE 
  (count % 2 = 1 AND rank = (count + 1) / 2) OR 
  (count % 2 = 0 AND ABS(rank - 0.5 - count / 2) = 0.5)
GROUP BY continent</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/youngest_over_35">Youngest person over 35</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">SELECT name
FROM people
WHERE age = (
  SELECT MIN(age)
  FROM people
  WHERE age &gt; 35)
LIMIT 1</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/tom_hanks">Directors of movies Tom Hanks starred in</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:207px"></div></div><pre style="width:100%;height:207px;line-height:1.3em">

SELECT directors.director
FROM 
  directors 
  INNER JOIN actors
  ON directors.movie = 
  actors.movie
WHERE actors.actor=&quot;Tom Hanks&quot;
</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/row_per_child">Row per family to row per child</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:391px"></div></div><pre style="width:100%;height:391px;line-height:1.3em">SELECT 
  family,
  (&#x27;child&#x27; || child) AS child,
  (CASE child 
    WHEN 1 THEN dob_child1 
    WHEN 2 THEN dob_child2 
    WHEN 3 THEN dob_child3 
   END) AS dob,
  (CASE child 
    WHEN 1 THEN height_child1 
    WHEN 2 THEN height_child2 
    WHEN 3 THEN height_child3 
   END) AS height
FROM 
  families
  CROSS JOIN
  (SELECT 1 as child UNION VALUES (2), (3))</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/strings_to_numbers">Convert strings with different formats to numbers</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:230px"></div></div><pre style="width:100%;height:230px;line-height:1.3em">SELECT 
  CAST(
    REPLACE(
      value, 
      CASE format 
        WHEN &quot;comma_sep&quot; THEN &quot;,&quot; 
        WHEN &quot;under_sep&quot; THEN &quot;_&quot; 
      END, &quot;&quot;)
    AS integer)
FROM numbers</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/documents_with_infrequent_words">Documents with infrequent words</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:460px"></div></div><pre style="width:100%;height:460px;line-height:1.3em">-- NOTE: SQLite tokenize is case-insensitive by default, 
-- so this solution is NOT exactly like the others

CREATE VIRTUAL TABLE doc_index USING fts4(
  text, id, content=documents, tokenize=simple);    
INSERT INTO doc_index(doc_index) VALUES(&#x27;rebuild&#x27;);
CREATE VIRTUAL TABLE words USING fts4aux(doc_index);    

SELECT DISTINCT id
FROM 
  documents
  CROSS JOIN
  (SELECT DISTINCT term
   FROM words
   WHERE occurrences = 1) unique_words
WHERE
  (LOWER(text) LIKE &#x27;% &#x27; || term || &#x27; %&#x27;) OR
  (LOWER(text) LIKE term || &#x27; %&#x27;) OR
  (LOWER(text) LIKE &#x27;% &#x27; || term) OR
  (LOWER(text) LIKE term)</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/process_tweets">Filter and clean tweets</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:69px"></div></div><pre style="width:100%;height:69px;line-height:1.3em">SELECT LOWER(body) as body, ts
FROM data
WHERE language = &quot;en&quot; and is_retweet = &quot;false&quot;</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/purchased_all_food">People that purchased all possible items</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:138px"></div></div><pre style="width:100%;height:138px;line-height:1.3em">SELECT DISTINCT buyer
FROM orders o1
WHERE 
  (SELECT COUNT(DISTINCT food) FROM orders o2 
   WHERE o1.buyer = o2.buyer) = 
  (SELECT COUNT(*) FROM food)</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/unique_beer_drinkers">People who like a unique set of beer</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:552px"></div></div><pre style="width:100%;height:552px;line-height:1.3em">SELECT DISTINCT L1.name
FROM likes L1
WHERE NOT EXISTS(
    SELECT *
    FROM likes L2
    WHERE L1.name != L2.name
    AND NOT EXISTS(
        SELECT *
        FROM likes L3
        WHERE L3.name = L2.name
        AND NOT EXISTS(
            SELECT *
            FROM likes L4
            WHERE L4.name = L1.name
            AND L4.beer = L3.beer))
    AND NOT EXISTS(
        SELECT *
        FROM likes L5
        WHERE L5.name = L1.name
        AND NOT EXISTS(
            SELECT *
            FROM likes L6
            WHERE L6.name = L2.name
            AND L6.beer= L5.beer)))</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/rolling_average">Rolling average</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">SELECT
end.time as end_time,  AVG(other.x) as average
FROM data as end
JOIN data as other
ON other.time &lt;= end.time and
   other.time &gt; end.time - 7
GROUP BY end.time</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/average_window">Windowed average</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:92px"></div></div><pre style="width:100%;height:92px;line-height:1.3em">SELECT AVG(x) as x
FROM data
GROUP BY cast(time / 7 as int)
ORDER BY time</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/reachable">Reflexive-transitive closure</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:276px"></div></div><pre style="width:100%;height:276px;line-height:1.3em">WITH RECURSIVE
closure(source, target) AS (
  SELECT source, source FROM graph
  UNION
  SELECT source, target FROM graph
  UNION
  SELECT edge.source, path.target
  FROM closure as path JOIN graph as edge
  ON edge.target = path.source
)
SELECT S.target FROM closure as S
JOIN query ON S.source = query.source</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/scc">Strongly-connected components</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:345px"></div></div><pre style="width:100%;height:345px;line-height:1.3em">WITH RECURSIVE
closure(source, target) AS (
  SELECT DISTINCT source, target FROM graph
  UNION
  SELECT edge.source, path.target
  FROM closure as path JOIN graph as edge
  ON edge.target = path.source
),
component(v1, v2) AS (
  SELECT path.source, path.target
  FROM closure as path JOIN closure as path_
  ON path.source = path_.target AND path.target = path_.source
)
SELECT S.v2 FROM component as S
JOIN query ON S.v1 = query.source</pre></div></div></div></div></div><div class="sidebar"><div class="sidebar-sticky"><div class="minimap"><button class="toggle">Toggle All</button><div><input type="checkbox" checked=""/>Continent with the highest average population</div><div><input type="checkbox" checked=""/>First element that doesn&#x27;t change mean</div><div><input type="checkbox" checked=""/>Median population for each continent</div><div><input type="checkbox" checked=""/>Youngest person over 35</div><div><input type="checkbox" checked=""/>Directors of movies Tom Hanks starred in</div><div><input type="checkbox" checked=""/>Row per family to row per child</div><div><input type="checkbox" checked=""/>Convert strings with different formats to numbers</div><div><input type="checkbox" checked=""/>Documents with infrequent words</div><div><input type="checkbox" checked=""/>Filter and clean tweets</div><div><input type="checkbox" checked=""/>People that purchased all possible items</div><div><input type="checkbox" checked=""/>People who like a unique set of beer</div><div><input type="checkbox" checked=""/>Rolling average</div><div><input type="checkbox" checked=""/>Windowed average</div><div><input type="checkbox" checked=""/>Reflexive-transitive closure</div><div><input type="checkbox" checked=""/>Strongly-connected components</div></div></div></div></div></div><footer>Project by <a href="https://twitter.com/wcrichton">Will Crichton</a>, <a href="https://github.com/kovach">Scott Kovach</a>, and <a href="http://gleb.fyi/">Gleb Shevchuk</a>.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"lang":{"id":"sql","name":"SQL - SQLite"}},"__N_SSG":true},"page":"/lang/[id]","query":{"id":"sql"},"buildId":"F9gvR9U94bRRAvM8aWmyT","assetPrefix":"/expressiveness-benchmark","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/expressiveness-benchmark/_next/static/chunks/polyfills-d2769c16f665abc9d1ae.js"></script><script src="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/_app-45b4e7d3d7685d44ce45.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.456f604e8bed4feda205.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/lang/%5Bid%5D-69454a6dd0b4a4f0e0f7.js" async=""></script><script src="/expressiveness-benchmark/_next/static/F9gvR9U94bRRAvM8aWmyT/_buildManifest.js" async=""></script><script src="/expressiveness-benchmark/_next/static/F9gvR9U94bRRAvM8aWmyT/_ssgManifest.js" async=""></script></body></html>