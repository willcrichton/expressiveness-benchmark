<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Expressiveness Benchmark</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-16662292-3"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag(&#x27;js&#x27;, new Date());

        gtag(&#x27;config&#x27;, &#x27;UA-16662292-3&#x27;);
        </script><meta name="next-head-count" content="5"/><link rel="preload" href="/expressiveness-benchmark/_next/static/css/bb7eb15fa0f289a0fe43.css" as="style"/><link rel="stylesheet" href="/expressiveness-benchmark/_next/static/css/bb7eb15fa0f289a0fe43.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/_app-73083bb29ec45f84b02a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.9662a54cf737546376a6.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/lang/%5Bid%5D-e6258ee591b96865bd9a.js" as="script"/></head><body><div id="__next"><div id="container"><div class="title"><h1><a href="/expressiveness-benchmark">Expressiveness Benchmark</a></h1><nav><span class="desktop-inline"><a href="/expressiveness-benchmark">Task matrix</a></span><span class="mobile-inline"><a href="/expressiveness-benchmark">Benchmark</a></span><a href="/expressiveness-benchmark/analysis">Dataset analysis</a></nav></div><div class="pivot-view"><h2>Language<!-- -->: <!-- -->Python - Functional</h2><div class="column-container"><div class="main-content"><div class="main-scroll"><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/continent_by_population">Continent with the highest average population</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:276px"></div></div><pre style="width:100%;height:276px;line-height:1.3em">def continent_by_population(countries):
  continents = set([c[&#x27;continent&#x27;] for c in countries])
  populations_by_continent = [
    (continent, [c[&#x27;population&#x27;] for c in countries 
                 if c[&#x27;continent&#x27;] == continent])
    for continent in continents
  ]
  averages = [
    (continent, sum(pops) / len(pops))
    for continent, pops in populations_by_continent
  ]
  return max(averages, key=lambda t: t[1])[0]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/changing_mean">First element that doesn&#x27;t change mean</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:276px"></div></div><pre style="width:100%;height:276px;line-height:1.3em">

def changing_mean(vals):
  start_mean = sum([l[&#x27;value&#x27;] for l in vals])/len(vals)
  diff = lambda m, sm: abs(m - sm)
    
  for i,elem in enumerate(vals):
    new_ls = [x[&#x27;value&#x27;] for x in vals if x != elem]
    mean = sum(new_ls)/len(new_ls)
    if diff(mean,start_mean) &lt; 0.1:
      return i
  return None
</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/continent_median_population">Median population for each continent</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:506px"></div></div><pre style="width:100%;height:506px;line-height:1.3em">def continent_median_population(countries):
  continents = set([c[&#x27;continent&#x27;] for c in countries])
  populations = {
    continent: [
      c[&#x27;population&#x27;] for c in countries 
      if c[&#x27;continent&#x27;] == continent
    ]
    for continent in continents
  }
  
  def compute_median(pops):
    pops = sorted(pops)
    N = len(pops)
    if N % 2 == 1:
      return pops[(N - 1) // 2]
    else:
      return (pops[N // 2 - 1] + pops[N // 2]) / 2  
   
  return [
    {&quot;continent&quot;: continent, &quot;population&quot;: compute_median(pops)}
    for continent, pops in populations.items()
  ]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/youngest_over_35">Youngest person over 35</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:92px"></div></div><pre style="width:100%;height:92px;line-height:1.3em">def youngest_over_35(people):
  over_35 = [p for p in people if p[&#x27;age&#x27;] &gt; 35]
  youngest = min(over_35, default=None, key=lambda p: p[&#x27;age&#x27;])
  return youngest[&#x27;name&#x27;] if youngest is not None else None</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/tom_hanks">Directors of movies Tom Hanks starred in</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:138px"></div></div><pre style="width:100%;height:138px;line-height:1.3em">

def tom_hanks(actors,directors):
  movies = [a[&#x27;movie&#x27;] for a in actors if a[&#x27;actor&#x27;] == &#x27;Tom Hanks&#x27;]
  directors = [d[&#x27;director&#x27;] for d in directors if d[&#x27;movie&#x27;] in movies]
  return directors
</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/row_per_child">Row per family to row per child</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:207px"></div></div><pre style="width:100%;height:207px;line-height:1.3em">def row_per_child(families):
  return [
    {&#x27;family&#x27;: family[&#x27;family&#x27;],
     &#x27;child&#x27;: f&#x27;child{i}&#x27;,
     &#x27;dob&#x27;: family[f&#x27;dob_child{i}&#x27;],
     &#x27;height&#x27;: family[f&#x27;height_child{i}&#x27;]}
    for family in families    
    for i in [1, 2, 3]
  ]</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/strings_to_numbers">Convert strings with different formats to numbers</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:138px"></div></div><pre style="width:100%;height:138px;line-height:1.3em">def strings_to_numbers(numbers):
  return [
    int(row[&quot;value&quot;].replace(
      &quot;,&quot; if row[&quot;format&quot;] == &quot;comma_sep&quot; else &quot;_&quot;, &quot;&quot;))
    for row in numbers
  ]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/documents_with_infrequent_words">Documents with infrequent words</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:368px"></div></div><pre style="width:100%;height:368px;line-height:1.3em">def documents_with_infrequent_words(documents):
  words = [doc[&quot;text&quot;].split(&quot; &quot;) for doc in documents]
  words_flat = [w for ws in words for w in ws]
  freq = {
    word: words_flat.count(word) 
    for word in set(words_flat)
  }
  infrequent_words = set([
    word for word, count in freq.items() 
    if count == 1
  ])
  infrequent_docs = [
    documents[i][&quot;id&quot;] for i, ws in enumerate(words) 
    if len(set(ws) &amp; infrequent_words) &gt; 0
  ]
  return infrequent_docs</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/process_tweets">Filter and clean tweets</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:184px"></div></div><pre style="width:100%;height:184px;line-height:1.3em">def process_tweets(data):
  return [
    {&quot;body&quot;: value[&quot;body&quot;].lower(),
     &quot;ts&quot;: value[&quot;ts&quot;]}
    for value in data
    if value[&quot;language&quot;] == &quot;en&quot; and
       value[&quot;is_retweet&quot;] == &quot;false&quot; 
  ]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/purchased_all_food">People that purchased all possible items</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:207px"></div></div><pre style="width:100%;height:207px;line-height:1.3em">def purchased_all_food(food, orders):
    n_food = len(food)
    buyers = set([order[&quot;buyer&quot;] for order in orders])
    return [
        buyer
        for buyer in buyers
        if len(set([order[&quot;food&quot;] for order in orders 
             if order[&quot;buyer&quot;] == buyer])) == n_food
    ]</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/unique_beer_drinkers">People who like a unique set of beer</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:345px"></div></div><pre style="width:100%;height:345px;line-height:1.3em">def unique_beer_drinkers(likes):
  people = set([row[&#x27;name&#x27;] for row in likes])
  likes_per_person = {
    name: set([row[&#x27;beer&#x27;] for row in likes if row[&#x27;name&#x27;] == name])
    for name in people
  }
    
  return [
    name
    for name, beers in likes_per_person.items()
    if not any([
      other_name != name and beers == other_beers
      for other_name, other_beers in likes_per_person.items()
    ])
  ]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/rolling_average">Rolling average</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:253px"></div></div><pre style="width:100%;height:253px;line-height:1.3em">def rolling_average(data):
  return [
    {&quot;end_time&quot;: x[&quot;time&quot;],
     &quot;average&quot;: sum(vs) / len(vs)}
    for x in data
    for vs in [
      [y[&quot;x&quot;] for y in data
              if y[&quot;time&quot;] &lt;= x[&quot;time&quot;] and
                 y[&quot;time&quot;] &gt; x[&quot;time&quot;] - 7]
    ]
  ]</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/average_window">Windowed average</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:253px"></div></div><pre style="width:100%;height:253px;line-height:1.3em">def average_window(data):
  def window(value):
    return math.floor(value[&quot;time&quot;] / 7)
  grouped_values = [
    [point[&quot;x&quot;] for point in data if window(point) == w]
    for w in set(map(window, data))
  ]
  return [
    sum(values) / len(values)
    for values in grouped_values
  ]</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/task/reachable">Reflexive-transitive closure</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:368px"></div></div><pre style="width:100%;height:368px;line-height:1.3em">def reachable(graph, query):
  def step(visited):
    frontier = set([
      edge[&quot;target&quot;]
      for vertex in visited
      for edge in graph
      if vertex == edge[&quot;source&quot;]
    ])
    return frontier.union(visited)

  def fix(f, x):
    next = f(x)
    return x if next == x else fix(f, next)

  source = query[0][&quot;source&quot;]
  return list(fix(step, set([source])))</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/task/scc">Strongly-connected components</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:414px"></div></div><pre style="width:100%;height:414px;line-height:1.3em">def scc(graph, query):
    def step(relation):
        return set([
            (source, edge[&quot;target&quot;])
            for (source, target) in relation
            for edge in graph
            if target == edge[&quot;source&quot;]
        ]).union(relation)

    def fix(f, x):
        next = f(x)
        return x if next == x else fix(f, next)

    source = query[0][&quot;source&quot;]
    init = set([(edge[&quot;source&quot;], edge[&quot;target&quot;]) for edge in graph])
    reachable = fix(step, init)
    return list(set([v for (_, v) in reachable
      if (v, source) in reachable and (source, v) in reachable]))</pre></div></div></div></div></div><div class="sidebar"><div class="sidebar-sticky"><div class="minimap"><button class="toggle">Toggle All</button><div><input type="checkbox" checked=""/>Continent with the highest average population</div><div><input type="checkbox" checked=""/>First element that doesn&#x27;t change mean</div><div><input type="checkbox" checked=""/>Median population for each continent</div><div><input type="checkbox" checked=""/>Youngest person over 35</div><div><input type="checkbox" checked=""/>Directors of movies Tom Hanks starred in</div><div><input type="checkbox" checked=""/>Row per family to row per child</div><div><input type="checkbox" checked=""/>Convert strings with different formats to numbers</div><div><input type="checkbox" checked=""/>Documents with infrequent words</div><div><input type="checkbox" checked=""/>Filter and clean tweets</div><div><input type="checkbox" checked=""/>People that purchased all possible items</div><div><input type="checkbox" checked=""/>People who like a unique set of beer</div><div><input type="checkbox" checked=""/>Rolling average</div><div><input type="checkbox" checked=""/>Windowed average</div><div><input type="checkbox" checked=""/>Reflexive-transitive closure</div><div><input type="checkbox" checked=""/>Strongly-connected components</div></div></div></div></div></div><footer>Project by <a href="https://twitter.com/wcrichton">Will Crichton</a>, <a href="https://github.com/kovach">Scott Kovach</a>, and <a href="http://gleb.fyi/">Gleb Shevchuk</a>.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"lang":{"id":"python-functional","name":"Python - Functional"}},"__N_SSG":true},"page":"/lang/[id]","query":{"id":"python-functional"},"buildId":"UAi9pXhyWdjqPaekVeAOd","assetPrefix":"/expressiveness-benchmark","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/expressiveness-benchmark/_next/static/chunks/polyfills-d2769c16f665abc9d1ae.js"></script><script src="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/_app-73083bb29ec45f84b02a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.9662a54cf737546376a6.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/lang/%5Bid%5D-e6258ee591b96865bd9a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/UAi9pXhyWdjqPaekVeAOd/_buildManifest.js" async=""></script><script src="/expressiveness-benchmark/_next/static/UAi9pXhyWdjqPaekVeAOd/_ssgManifest.js" async=""></script></body></html>