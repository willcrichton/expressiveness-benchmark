<!DOCTYPE html><html><head><meta charSet="utf-8"/><title>Expressiveness Benchmark</title><meta name="viewport" content="initial-scale=1.0, width=device-width"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-16662292-3"></script><script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag(&#x27;js&#x27;, new Date());

        gtag(&#x27;config&#x27;, &#x27;UA-16662292-3&#x27;);
        </script><meta name="next-head-count" content="5"/><link rel="preload" href="/expressiveness-benchmark/_next/static/css/923b377aad6d2aff8159.css" as="style"/><link rel="stylesheet" href="/expressiveness-benchmark/_next/static/css/923b377aad6d2aff8159.css" data-n-g=""/><noscript data-n-css=""></noscript><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/_app-73821011f106e1ce2c2a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.456f604e8bed4feda205.js" as="script"/><link rel="preload" href="/expressiveness-benchmark/_next/static/chunks/pages/task/%5Bid%5D-ebb6244aed139452441b.js" as="script"/></head><body><div id="__next"><div id="container"><div class="title"><h1><a href="/expressiveness-benchmark">Expressiveness Benchmark</a></h1><nav><span class="desktop-inline"><a href="/expressiveness-benchmark">Task matrix</a></span><span class="mobile-inline"><a href="/expressiveness-benchmark">Benchmark</a></span><a href="/expressiveness-benchmark/analysis">Dataset analysis</a></nav></div><div class="pivot-view"><h2>Task<!-- -->: <!-- -->Documents with infrequent words</h2><div class="column-container"><div class="main-content"><div class="main-sticky"><div class="task-spec"><strong>Specification: </strong>F<!-- -->i<!-- -->n<!-- -->d<!-- --> <!-- -->t<!-- -->h<!-- -->e<!-- --> <!-- -->i<!-- -->n<!-- -->d<!-- -->e<!-- -->x<!-- --> <!-- -->o<!-- -->f<!-- --> <span class="goal" style="background:rgba(141, 229, 161, 0.5);border:2px solid rgba(141, 229, 161, 1)">documents that contain a word</span> <!-- -->t<!-- -->h<!-- -->a<!-- -->t<!-- --> <span class="goal" style="background:rgba(255, 180, 130, 0.5);border:2px solid rgba(255, 180, 130, 1)">appears exactly once</span> <!-- -->i<!-- -->n<!-- --> <!-- -->t<!-- -->h<!-- -->e<!-- --> <!-- -->c<!-- -->o<!-- -->r<!-- -->p<!-- -->u<!-- -->s<!-- -->,<!-- --> <!-- -->w<!-- -->h<!-- -->e<!-- -->r<!-- -->e<!-- --> <!-- -->a<!-- --> <!-- -->w<!-- -->o<!-- -->r<!-- -->d<!-- --> <!-- -->i<!-- -->s<!-- --> <!-- -->a<!-- --> <span class="goal" style="background:rgba(161, 201, 244, 0.5);border:2px solid rgba(161, 201, 244, 1)">case-sensitive string of characters separated by a space</span>.</div></div><div class="main-scroll"><div class="io"><strong class="header">Example input/output:</strong><div class="data-container"><div class="input"><strong>Input:</strong> <code>documents</code><table><thead><tr><th>id</th><th>text</th></tr></thead><tbody><tr><td><code>1</code></td><td><code>Hello world</code></td></tr><tr><td><code>2</code></td><td><code>Hello friend</code></td></tr><tr><td><code>3</code></td><td><code>friend of the world</code></td></tr><tr><td><code>4</code></td><td><code>Hola</code></td></tr></tbody></table></div><div class="output"><strong>Output:</strong> <code>[<!-- -->3<!-- -->, <!-- -->4<!-- -->]</code></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/python-imperative">Python - Imperative</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:483px"></div></div><pre style="width:100%;height:483px;line-height:1.3em">def documents_with_infrequent_words(documents):
  words = {}
  freq = defaultdict(int)
  for doc in documents:
    words[doc[&quot;id&quot;]] = doc[&quot;text&quot;].split(&quot; &quot;)
    for word in words[doc[&quot;id&quot;]]:
      freq[word] += 1
      
  infrequent_words = set()
  for word, count in freq.items():
    if count == 1:
      infrequent_words.add(word)
      
  infrequent_docs = []
  for doc in documents:
    for word in words[doc[&quot;id&quot;]]:
      if word in infrequent_words:
        infrequent_docs.append(doc[&quot;id&quot;])
        break
        
  return infrequent_docs</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/language/python-functional">Python - Functional</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:368px"></div></div><pre style="width:100%;height:368px;line-height:1.3em">def documents_with_infrequent_words(documents):
  words = [doc[&quot;text&quot;].split(&quot; &quot;) for doc in documents]
  words_flat = [w for ws in words for w in ws]
  freq = {
    word: words_flat.count(word) 
    for word in set(words_flat)
  }
  infrequent_words = set([
    word for word, count in freq.items() 
    if count == 1
  ])
  infrequent_docs = [
    documents[i][&quot;id&quot;] for i, ws in enumerate(words) 
    if len(set(ws) &amp; infrequent_words) &gt; 0
  ]
  return infrequent_docs</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/python-pandas">Python - Pandas</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:161px"></div></div><pre style="width:100%;height:161px;line-height:1.3em">def documents_with_infrequent_words(documents):
  words = documents.text.str.split(&quot; &quot;, expand=True)
  freq = words.stack().value_counts()
  infrequent_words = freq[freq == 1].index.values
  infrequent_docs = documents[
    np.isin(words.values, infrequent_words)]
  return infrequent_docs.id.unique().tolist()</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/language/r">R - Tidyverse</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:253px"></div></div><pre style="width:100%;height:253px;line-height:1.3em">documents_with_infrequent_words &lt;- function(documents) {
  split &lt;- documents %&gt;%
    mutate(word = str_split(text, &quot; &quot;)) %&gt;%
    unnest()
  freq &lt;- split %&gt;% count(word)
  unique_words &lt;- freq %&gt;% filter(n == 1)
  split %&gt;% 
    filter(word %in% unique_words$word) %&gt;%
    pull(id) %&gt;%
    unique()
}</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/sql">SQL - SQLite</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:460px"></div></div><pre style="width:100%;height:460px;line-height:1.3em">-- NOTE: SQLite tokenize is case-insensitive by default, 
-- so this solution is NOT exactly like the others

CREATE VIRTUAL TABLE doc_index USING fts4(
  text, id, content=documents, tokenize=simple);    
INSERT INTO doc_index(doc_index) VALUES(&#x27;rebuild&#x27;);
CREATE VIRTUAL TABLE words USING fts4aux(doc_index);    

SELECT DISTINCT id
FROM 
  documents
  CROSS JOIN
  (SELECT DISTINCT term
   FROM words
   WHERE occurrences = 1) unique_words
WHERE
  (LOWER(text) LIKE &#x27;% &#x27; || term || &#x27; %&#x27;) OR
  (LOWER(text) LIKE term || &#x27; %&#x27;) OR
  (LOWER(text) LIKE &#x27;% &#x27; || term) OR
  (LOWER(text) LIKE term)</pre></div></div><div class="program-container"><h3><a href="/expressiveness-benchmark/language/datalog">Datalog - Souffle</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:506px"></div></div><pre style="width:100%;height:506px;line-height:1.3em">.decl substrs(Text:symbol, Idx:number, Len:number)
substrs(Text, 0, 1) :- 
  documents(_, Text), strlen(Text) &gt; 0.
substrs(Text, 0, Len+1) :- 
  substrs(Text, 0, Len), Len + 1 &lt;= strlen(Text).
substrs(Text, Idx+1, Len) :- 
  substrs(Text, Idx, Len), Idx + Len + 1 &lt;= strlen(Text).

.decl token(Docid:number, Text:symbol, Idx:number, Word:symbol)
token(Docid, Text, Idx, Word) :-
  documents(Docid, Text),
  substrs(Text, Idx, Len),
  Prev = Idx - 1, Next = Idx + Len,
  (Prev &lt; 0; &quot; &quot; = substr(Text, Prev, 1)),
  (Next = strlen(Text); &quot; &quot; = substr(Text, Next, 1)),
  Word = substr(Text, Idx, Len),
  !contains(&quot; &quot;, Word).

documents_with_infrequent_words(Id) :-
  documents(Id, _),
  token(Id, _, _, Word),
  1 = count : token(_, _, _, Word).</pre></div></div></div><div class="program-row"><div class="program-container"><h3><a href="/expressiveness-benchmark/language/q">Q - kdb+</a></h3><div class="code-viewer"><div style="display:none"><div id="ace-editor" style="width:100%;height:115px"></div></div><pre style="width:100%;height:115px;line-height:1.3em">words: (&quot; &quot; vs) each documents[`text];
freq: count each group raze words;
uniq: where[freq=1];
documents_with_infrequent_words:
  (select id from documents where &#x27;[any; in\: [;uniq]] each words) `id</pre></div></div></div></div></div><div class="sidebar"><div class="sidebar-sticky"><div class="minimap"><button class="toggle">Toggle All</button><div><input type="checkbox" checked=""/>Python - Imperative</div><div><input type="checkbox" checked=""/>Python - Functional</div><div><input type="checkbox" checked=""/>Python - Pandas</div><div><input type="checkbox" checked=""/>R - Tidyverse</div><div><input type="checkbox" checked=""/>SQL - SQLite</div><div><input type="checkbox" checked=""/>Datalog - Souffle</div><div><input type="checkbox" checked=""/>Q - kdb+</div></div></div></div></div></div><footer>Project by <a href="https://twitter.com/wcrichton">Will Crichton</a>, <a href="https://github.com/kovach">Scott Kovach</a>, and <a href="http://gleb.fyi/">Gleb Shevchuk</a>.</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"task":{"id":"documents_with_infrequent_words","category":"Strings","name":"Documents with infrequent words","description":"Find the index of documents that contain a word that appears exactly once in the corpus, where a word is a case-sensitive string of characters separated by a space.","plan":[{"id":"word","description":"case-sensitive string of characters separated by a space"},{"id":"frequency","description":"appears exactly once"},{"id":"documents","description":"documents that contain a word"}],"sample_input":{"documents":[{"id":1,"text":"Hello world"},{"id":2,"text":"Hello friend"},{"id":3,"text":"friend of the world"},{"id":4,"text":"Hola"}]},"sample_output":[3,4]}},"__N_SSG":true},"page":"/task/[id]","query":{"id":"documents_with_infrequent_words"},"buildId":"vDR8ehcoSoupAMXzCtM3B","assetPrefix":"/expressiveness-benchmark","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/expressiveness-benchmark/_next/static/chunks/polyfills-d2769c16f665abc9d1ae.js"></script><script src="/expressiveness-benchmark/_next/static/chunks/main-f76717e2d376ecc40880.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/webpack-95c2b224bccf352ee870.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/framework.be9133c4aa54b58ca1d2.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/commons.2ac40408ef03d6c65327.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/_app-73821011f106e1ce2c2a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/48fe5443.8cbf9bb7b72041d99e6c.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/29107295.0ba1e3749ecd6faab06a.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/f7f3ae4b7ca4f7fc373506a61db832ad86bd3f74.456f604e8bed4feda205.js" async=""></script><script src="/expressiveness-benchmark/_next/static/chunks/pages/task/%5Bid%5D-ebb6244aed139452441b.js" async=""></script><script src="/expressiveness-benchmark/_next/static/vDR8ehcoSoupAMXzCtM3B/_buildManifest.js" async=""></script><script src="/expressiveness-benchmark/_next/static/vDR8ehcoSoupAMXzCtM3B/_ssgManifest.js" async=""></script></body></html>